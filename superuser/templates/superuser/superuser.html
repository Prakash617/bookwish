{% extends 'superuser-base.html' %}
{% comment %} total_active_users {% endcomment %}



{% block title %} Admin Dashboard | The Book Wishes Club {%endblock%}

{% block main %}
<div class="row rounded-9 users mb-5">
    <div class="col-lg-3">
        <div class="card">
            <div class="card-body">
                <div class="mb-4 text-center px-2 shadow py-1 rounded-9" style="width:fit-content;">
                    <i class="fas fa-users fa-fw"></i>
                </div>
                <div class="fw-bold text-primary">
                    Total Users
                </div>
                <div class="fs-1 fw-bold">
                    {{total_users}}
                </div>

            </div>
        </div>
    </div>
    <div class="col-lg-3">
        <div class="card">
            <div class="card-body">
                <div class="mb-4 text-center px-2 shadow py-1 rounded-9" style="width:fit-content;">
                    <i class="fas fa-users fa-fw"></i>
                </div>
                <div class="fw-bold text-primary">
                    Active Users(current month)
                </div>
                <div class="fs-1 fw-bold">
                    {{total_active_users_month}}
                </div>

            </div>
        </div>
    </div>

    <div class="col-lg-3">
        <div class="card">
            <div class="card-body">
                <div class="mb-4 text-center px-2 shadow py-1 rounded-9 position-relative" style="width:fit-content;">
                    <i class="fas fa-users fa-fw"></i>
                    <div class="green-badge bg-success position-absolute rounded"
                        style="width:9px; height:9px; bottom: 0; right:0px;">
                    </div>
                </div>
                <div class="fw-bold text-primary">
                    Active Users
                </div>
                <div class="fs-1 fw-bold">
                    {{total_active_users}}
                </div>

            </div>
        </div>
    </div>

    <div class="col-lg-3">
        <div class="card">
            <div class="card-body">
                <div class="mb-4 text-center px-2 shadow py-1 rounded-9" style="width:fit-content;">
                    <i class="fas fa-user-friends"></i>
                </div>
                <div class="fw-bold text-primary">
                    {% if request.user.is_superuser %}
                        Total Club
                        {% else %}
                    Club
                    {% endif %}

                </div>
                <div class="fs-1 fw-bold">
                    {% if request.user.is_superuser %}
                        {{total_clubs}}
                    {% else %}
                    {{request.user.club}}
                    {% endif %}
                </div>

            </div>
        </div>
    </div>


</div>



<!-- Today's Tools Summary   -->
<div class="container-fluid rounded-9 tools pt-3">
    <hr>

    <div class="h3 fw-bold text-primary">Today's Tools Summary</div>


    <div class="row mt-3">
        <div class="col-lg-4 mb-3">
            <div class="step-counter my-2 card px-2" style="width: fit-content">
                <div class="text-warning ">Step Counter</div>
            </div>
            <div class="card">
                <div class="bubbles bg-warning" style="bottom: -18px; right: -12px;"></div>
                <div class="card-body">
                    <div class="title text-warning">
                        Distance Walked
                    </div>
                    <div class="data mt-2">
                        {% comment %} <div class="progress">
                            <div class="progress-bar progress-bar-striped bg-warning" role="progressbar"
                                style="width: 75%;" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100"></div>
                        </div> {% endcomment %}
                        <div class="data mt-2">
                            <div class="fs-4 text-warning">
                                {{step}} km
                            </div>
                        </div>
                    </div>
                    {% comment %} <div class="text-warning small">
                        {{step}} km
                    </div> {% endcomment %}
                </div>
            </div>

        </div>


        <div class="col-lg-4 mb-3">
            <div class="step-counter my-2 card px-2" style="width: fit-content">
                <div class="text-danger">Book Reads</div>
            </div>
            <div class="card ">
                <div class="bubbles bg-danger" style="bottom: -18px; right: -12px;"></div>
                <div class="card-body">
                    <div class="title text-danger">
                        No. Pages Read
                        {% comment %} {{pages}} {% endcomment %}
                        {% comment %} {% widthratio 5 1 2 %} {% endcomment %}
                        {% widthratio total_pages pages 1  %}
                    </div>
                    <div class="data mt-2">
                        {% comment %} <div class="progress">
                            <div class="progress-bar progress-bar-striped bg-danger" role="progressbar"
                                style="width: {% widthratio total_pages pages 1  %}" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100"></div>
                        </div> {% endcomment %}
                        <div class="data mt-2">
                            <div class="fs-4 text-danger">
                                {{pages}} pages
                            </div>
                        </div>
                    </div>
                    {% comment %} <div class="text-danger small">
                        
                    </div> {% endcomment %}
                </div>
            </div>

        </div>



        <div class="col-lg-4 mb-3">
            <div class="step-counter my-2 card px-2" style="width: fit-content">
                <div class="text-dark">Relationship Stats</div>
            </div>
            <div class="card">
                <div class="bubbles bg-success" style="bottom: -18px; right: -12px;"></div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-lg-6">
                            <div class="title small text-success">
                                Positive Stats
                            </div>
                            <div class="data mt-2">
                                <div class="fs-4 text-success">
                                    +{{pos_points}}
                                </div>
                            </div>
                        </div>

                        <div class="col-lg-6">
                            <div class="title small text-primary">
                                Negative Stats
                            </div>
                            <div class="data mt-2">
                                <div class="fs-4 text-primary">
                                    +{{neg_points}}
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>




        </div>


        {% comment %} <div class="col-lg-4">
            <div class="step-counter my-2 card px-2" style="width: fit-content">
                <div class="text-info">Screen Time</div>
            </div>
            <div class="card ">
                <div class="bubbles bg-info" style="bottom: -18px; right: -12px;"></div>
                <div class="card-body">
                    <div class="title text-info">
                        Total Screen Time
                    </div>
                    <div class="data mt-2">
                        <div class="fs-4 text-info">
                            50h 32minutes
                        </div>
                    </div>

                </div>
            </div>

        </div> {% endcomment %}
    </div>

</div>




<!-- Other Datas -->
<div class="container-fluid rounded-9 tools pt-3 mt-5">
    <hr>

    <div class="h3 fw-bold text-primary">Today's Stats</div>


    <div class="row rounded-9 mb-5 mt-4">

        <div class="col-lg-3">
            <div class="card">
                <div class="bubbles bg-success" style="top: 42%; right: -12px;"></div>
                <div class="card-body">
                    <div class="fw-bold text-success">
                        Total Site Visits
                    </div>
                    <div class="fs-1 fw-bold text-success">
                        30
                    </div>
                </div>
            </div>
        </div>

        <div class="col-lg-3">
            <div class="card">
                <div class="bubbles bg-warning" style="top: 42%; right: -12px;"></div>
                <div class="card-body">
                    <div class="fw-bold text-warning">
                        Total Posts Today
                    </div>
                    <div class="fs-1 fw-bold text-warning">
                        {{total_posts_today}}
                    </div>
                </div>
            </div>
        </div>

        <div class="col-lg-3">
            <div class="card">
                <div class="bubbles bg-dark" style="top: 42%; right: -12px;"></div>
                <div class="card-body">
                    <div class="fw-bold text-dark">
                        Total Tips Today
                    </div>
                    <div class="fs-1 fw-bold text-dark">
                            {{total_stories}}
                    </div>
                </div>
            </div>
        </div>

    </div>

</div>



<!-- Section: Main chart -->
<section class="mb-4 pt-5">
    <div class="card inflow">
        <div class="card-header py-3">
            <h5 class="mb-0 text-center"><strong>Inflow Chart</strong></h5>
        </div>
        <div class="card-body">
            <canvas class="my-4 w-100" id="myChart" height="380"></canvas>
        </div>
    </div>
</section>
<!-- Section: Main chart -->


{%endblock%}



{%block js%}
<script>
    $(function () {
        // Graph
        var ctx = document.getElementById("myChart");

        var myChart = new Chart(ctx, {
            type: "line",
            data: {
                labels: [
                    "Jan",
                    "Feb",
                    "Mar",
                    "Apr",
                    "May",
                    "Jun",
                    "July",
                    "Aug",
                    "Sep",
                    "Oct",
                    "Nov",
                    "Dec"
                ],
                datasets: [
                    {
                        label: "Active Users",
                        data: [19, 25, 13, 23, 29, 22, 34, 34, 21, 23, 323, 329],
                        lineTension: 0.3,
                        backgroundColor: "transparent",
                        borderColor: "#007bff",
                        borderWidth: 4,
                        pointBackgroundColor: "#007bff",
                    },

                    {
                        label: "Premium Users",
                        data: [139, 215, 184, 203, 289, 292, 134, 34, 13, 45, 56, 233, 300],
                        lineTension: 0.3,
                        backgroundColor: "transparent",
                        borderColor: '#f93154',
                        borderWidth: 4,
                        pointBackgroundColor: "#007bff",
                    },
                ],
            },
            options: {
                scales: {
                    yAxes: [
                        {
                            ticks: {
                                beginAtZero: true,
                            },
                        },
                    ],

                },
                legend: {
                    display: false,
                },
            },
        });


        $(function () {
            $(".list-group-item").each(function () {
                $(".active").removeClass(".active");
                if ($(this).text().toLowerCase().includes("dashboard")) {
                    $(this).addClass("active");
                }
            });
    
            $(document).ready(function () {
                $("#table_id").DataTable();
            });
        });
    })
</script>
{%endblock%}